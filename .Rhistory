install.packages("learnr")
source('D:/Scientific_Research/Github/zzwch/crosslink/R/utils.R', echo=TRUE)
source('D:/Scientific_Research/Github/zzwch/crosslink/R/crosslink.R', echo=TRUE)
todataframe_by_list(list(c(1:10), c(rep("A", 5), rep("B", 5))))
todataframe_by_list(list(num = c(1:10), cat = c(rep("A", 5), rep("B", 5))))
segment_range(c(0,1), 3, scale = c(1, 2, 7))
segment_range(c(0,10), 3, scale = c(1, 2, 7))
segment_range(c(1,10), 3, scale = c(1, 2, 7))
segment_range(c(1,10), 3, scale = c(1, 2, 6))
segment_range(c(1,10), 3, scale = c(1, 2, 6), return.cutter = F)
vector_to_coord(1:4, scale = c(1,2,2,2,1), range(1, 10))
vector_to_coord(1:4, scale = c(1,2,2,2,1), range(1, 9))
index_to_name(data.frame(A = 1, B = 2), 1)
#' Title
#'
#' @param x
#' @param ind
#'
#' @return
#' @export
#'
#' @examples
index_to_name <- function(x, ind){
if(is.numeric(ind)){
if(max(ind) <= length(x))
return(names(x)[ind])
else
stop("index is larger than length of x")
}
if(all(ind %in% names(x)))
return(ind)
else
stop("index is not in names of x")
}
index_to_name(data.frame(A = 1, B = 2), 1)
transform_matrix_affine(type = "rotate", x = 1, y = 1, theta = 90)
transform_matrix_affine(type = "rotate", x = 1, y = 1, theta = 90) %*% c(0, 0)
transform_matrix_affine(type = "rotate", x = 1, y = 1, theta = 90) %*% c(0, 0, 0)
transform_matrix_affine(type = "rotate", x = 1, y = 1, theta = 90) %*% c(0, 0, 1)
transform_matrix_affine(type = "rotate", x = 1, y = 1, theta = pi/2) %*% c(0, 0, 1)
mat <- transform_matrix_affine(type = "translate", x = 1, y = 2)
mat %*% c(0, 0, 1)
mat <- transform_matrix_affine(type = "shear", x = pi*15/180, y = 0)
mat %*% c(0, 0, 1)
mat %*% c(0, 1, 1)
mat <- transform_matrix_affine(type = "shear", x = pi*45/180, y = 0)
mat %*% c(0, 1, 1)
mat <- transform_matrix_affine(type = "shear", x = 0, y = pi*45/180)
mat %*% c(0, 1, 1)
mat <- transform_matrix_affine(type = "shear", x = pi*45/180, y = 0)
mat %*% c(0, 1, 1)
mat %*% c(1, 1, 1)
mat <- transform_matrix_affine(type = "shear", x = 0, y = pi*45/180)
mat %*% c(1, 1, 1)
mat <- transform_matrix_affine(type = "shear", x = 0, y = pi*45/180, counterclockwise = T)
mat %*% c(1, 1, 1)
tan(pi*45/180)
tan(-pi*45/180)
tan(0)
mat <- transform_matrix_affine(type = "shear", x = 0, y = pi*45/180, counterclockwise = T)
tan(0)
mat %*% c(1, 1, 1)
mat <- transform_matrix_affine(type = "shear", x = 0, y = pi*45/180, counterclockwise = F)
mat %*% c(1, 1, 1)
ma
mat
#' mat <- transform_matrix_affine(type = "rotate", x = 1, y = 1, theta = pi/2)
#' mat %*% c(0, 0, 1)
#'
#' # shear for convert c(1, 1) to c(2, 1)
#' mat <- transform_matrix_affine(type = "shear", x = pi*45/180, y = 0)
#' mat <- transform_matrix_affine(type = "shear", x = 0, y = pi*45/180, counterclockwise = T)
#'
#' # reflect for convert c(0, 0) to c(0, 2)
#' mat <- transform_matrix_affine(type = "reflect", x = 0.5, y = 0.5, theta = pi*45/180)
#'
transform_matrix_affine <- function(
type = c("none", "translate", "scale", "rotate", "shear", "reflect"),
x = 0, y = 0, theta = NA, counterclockwise = FALSE){
# none: ignore everything
# translate: x, y
# scale: x, y
# rotate: x, y, theta (angle of the rotation)
# shear: x, y
# reflect: x, y, theta (angle with x axis)
if(counterclockwise) theta <- -theta
switch(
match.arg(arg = type, several.ok = FALSE),
none = transform_matrix(),
translate = transform_matrix(c = x, f = y),
scale = transform_matrix(a = x, e = y),
rotate = {
if(!is.numeric(theta)) stop("parameter theta must be numeric for ROTATE!")
transform_matrix(c = x, f = y) %*%
transform_matrix(a = cos(theta), b = sin(theta), d = -sin(theta), e = cos(theta)) %*%
transform_matrix(c = -x, f = -y)
},
shear = transform_matrix(b = tan(x * ifelse(counterclockwise, -1, 1)),
d = tan(-y * ifelse(counterclockwise, -1, 1))),
reflect = {
if(is.na(theta) || is.null(theta)){
transform_matrix(c = x, f = y) %*%
transform_matrix(a = -1, e = -1) %*%
transform_matrix(c = -x, f = -y)
}else{
transform_matrix(c = x, f = y) %*%
transform_matrix(a = cos(theta), b = sin(theta), d = -sin(theta), e = cos(theta)) %*%
transform_matrix(a = 1, e = -1) %*%
transform_matrix(a = cos(-theta), b = sin(-theta), d = -sin(-theta), e = cos(-theta)) %*%
transform_matrix(c = -x, f = -y)
}
)
}
mat <- transform_matrix_affine(type = "shear", x = 0, y = pi*45/180, counterclockwise = F)
mat %*% c(1, 1, 1)
mat <- transform_matrix_affine(type = "shear", x = 0, y = pi*45/180, counterclockwise = T)
mat %*% c(1, 1, 1)
mat <- transform_matrix_affine(type = "reflect", x = 0.5, y = 0.5, theta = pi*45/180)
mat <- transform_matrix_affine(type = "reflect", x = 1, y = 1, theta = pi*45/180)
mat %*% c(1, 1, 1)
mat %*% c(0, 0, 1)
transform_by_matrix(x = expand.grid(c(0,1), c(0,1)), matrix = transform_matrix_affine("shear", x= pi/4))
transform_by_matrix(x = expand.grid(c(0,1), c(0,1)), matrix = transform_matrix_affine("shear", x= pi/4)) %>% plot
plot(transform_by_matrix(x = expand.grid(c(0,1), c(0,1)), matrix = transform_matrix_affine("shear", x= pi/4)))
library(ggplot2)
us <- expand.grid(c(0,1), c(0,1))
us_tf <- transform_by_matrix(x = us, matrix = transform_matrix_affine("shear", x= pi/4))
ggplot() + geom_segment(x = us[,1], y = us[,2], xend = us_tf[,1], yend = us_tf[,2])
ggplot() + geom_segment(x = us[,1], y = us[,2], xend = us_tf[,1], yend = us_tf[,2], color = "red")
View(us_tf)
ggplot() + geom_segment(x = us[,1], y = us[,2], xend = us_tf[,1], yend = us_tf[,2], color = "red", mapping = aes)
ggplot() + geom_segment(x = us[,1], y = us[,2], xend = us_tf[,1], yend = us_tf[,2], color = "red", mapping = aes())
ggplot() + geom_segment(mapping = aes(x = us[,1], y = us[,2], xend = us_tf[,1], yend = us_tf[,2]), color = "red")
us_tf <- transform_by_matrix(x = us, matrix = transform_matrix_affine("rotate", x = 0, y =0, theta = pi/4))
ggplot() + geom_segment(mapping = aes(x = us[,1], y = us[,2], xend = us_tf[,1], yend = us_tf[,2]), color = "red")
ggplot() + geom_segment(mapping = aes(x = us[,1], y = us[,2], xend = us_tf[,1], yend = us_tf[,2]), color = "red") +geom_path(mapping = aes(x = us[,1], y = us[,2]))
ggplot() + geom_segment(mapping = aes(x = us[,1], y = us[,2], xend = us_tf[,1], yend = us_tf[,2]), color = "red") +geom_polygon(mapping = aes(x = us[,1], y = us[,2]))
us
us <- expand.grid(c(0,1), c(0,1))[c(1,3,4,2),]
us_tf <- transform_by_matrix(x = us, matrix = transform_matrix_affine("rotate", x = 0, y =0, theta = pi/4))
ggplot() + geom_segment(mapping = aes(x = us[,1], y = us[,2], xend = us_tf[,1], yend = us_tf[,2]), color = "red") +geom_polygon(mapping = aes(x = us[,1], y = us[,2]))
ggplot() + geom_polygon(mapping = aes(x = us[,1], y = us[,2])) +geom_segment(mapping = aes(x = us[,1], y = us[,2], xend = us_tf[,1], yend = us_tf[,2]), color = "red")
ggplot() +
geom_polygon(mapping = aes(x = us[,1], y = us[,2])) +
geom_segment(mapping = aes(x = us[,1], y = us[,2], xend = us_tf[,1], yend = us_tf[,2]), color = "red")
ggplot() +
geom_polygon(mapping = aes(x = us[,1], y = us[,2]), color = "blue", alpha = 0.3) +
geom_polygon(mapping = aes(x = us[,1], y = us[,2])) +
geom_segment(mapping = aes(x = us[,1], y = us[,2], xend = us_tf[,1], yend = us_tf[,2]), color = "red")
ggplot() +
geom_polygon(mapping = aes(x = us[,1], y = us[,2]), fill = "blue", alpha = 0.3) +
geom_polygon(mapping = aes(x = us[,1], y = us[,2])) +
geom_segment(mapping = aes(x = us[,1], y = us[,2], xend = us_tf[,1], yend = us_tf[,2]), color = "red")
ggplot() +
geom_polygon(mapping = aes(x = us[,1], y = us[,2]), fill = "blue", alpha = 0.3) +
geom_polygon(mapping = aes(x = us_tf[,1], y = us_tf[,2]), fill = "blue", alpha = 0.3) +
geom_segment(mapping = aes(x = us[,1], y = us[,2], xend = us_tf[,1], yend = us_tf[,2]), color = "red")
ggplot() +
geom_polygon(mapping = aes(x = us[,1], y = us[,2]), fill = "blue", alpha = 0.3) +
geom_polygon(mapping = aes(x = us_tf[,1], y = us_tf[,2]), fill = "blue", alpha = 0.3) +
geom_segment(mapping = aes(x = us[,1], y = us[,2], xend = us_tf[,1], yend = us_tf[,2]), color = "red") +
coord_fixed()
ggplot() +
geom_polygon(mapping = aes(x = us[,1], y = us[,2]), fill = "blue", alpha = 0.3) +
geom_polygon(mapping = aes(x = us_tf[,1], y = us_tf[,2]), fill = "blue", alpha = 0.3) +
geom_segment(mapping = aes(x = us[,1], y = us[,2], xend = us_tf[,1], yend = us_tf[,2]),
color = "red", size = 2, arrow = arrow()) +
coord_fixed()
ggplot() +
geom_polygon(mapping = aes(x = us[,1], y = us[,2]), fill = "blue", alpha = 0.3) +
geom_polygon(mapping = aes(x = us_tf[,1], y = us_tf[,2]), fill = "blue", alpha = 0.3) +
geom_segment(mapping = aes(x = us[,1], y = us[,2], xend = us_tf[,1], yend = us_tf[,2]),
color = "red", size = 2, arrow = arrow(type = "closed")) +
coord_fixed()
ggplot() +
geom_polygon(mapping = aes(x = us[,1], y = us[,2]), fill = "blue", alpha = 0.3) +
geom_polygon(mapping = aes(x = us_tf[,1], y = us_tf[,2]), fill = "blue", alpha = 0.3) +
geom_segment(mapping = aes(x = us[,1], y = us[,2], xend = us_tf[,1], yend = us_tf[,2]),
color = "red", size = 1, arrow = arrow(type = "closed")) +
coord_fixed()
ggplot() +
geom_polygon(mapping = aes(x = us[,1], y = us[,2]), fill = "blue", alpha = 0.3) +
geom_polygon(mapping = aes(x = us_tf[,1], y = us_tf[,2]), fill = "blue", alpha = 0.3) +
geom_segment(mapping = aes(x = us[,1], y = us[,2], xend = us_tf[,1], yend = us_tf[,2]),
color = "red", size = 1, arrow = arrow(type = "closed", length = 0.1)) +
coord_fixed()
ggplot() +
geom_polygon(mapping = aes(x = us[,1], y = us[,2]), fill = "blue", alpha = 0.3) +
geom_polygon(mapping = aes(x = us_tf[,1], y = us_tf[,2]), fill = "blue", alpha = 0.3) +
geom_segment(mapping = aes(x = us[,1], y = us[,2], xend = us_tf[,1], yend = us_tf[,2]),
color = "red", size = 1, arrow = arrow(type = "closed", length = unit(0.1, "pt"))) +
coord_fixed()
ggplot() +
geom_polygon(mapping = aes(x = us[,1], y = us[,2]), fill = "blue", alpha = 0.3) +
geom_polygon(mapping = aes(x = us_tf[,1], y = us_tf[,2]), fill = "blue", alpha = 0.3) +
geom_segment(mapping = aes(x = us[,1], y = us[,2], xend = us_tf[,1], yend = us_tf[,2]),
color = "red", size = 1, arrow = arrow(type = "closed", length = unit(0.1, "npc"))) +
coord_fixed()
ggplot() +
geom_polygon(mapping = aes(x = us[,1], y = us[,2]), fill = "blue", alpha = 0.3) +
geom_polygon(mapping = aes(x = us_tf[,1], y = us_tf[,2]), fill = "blue", alpha = 0.3) +
geom_segment(mapping = aes(x = us[,1], y = us[,2], xend = us_tf[,1], yend = us_tf[,2]),
color = "red", size = 1, arrow = arrow(type = "closed", length = unit(0.1, "points"))) +
coord_fixed()
ggplot() +
geom_polygon(mapping = aes(x = us[,1], y = us[,2]), fill = "blue", alpha = 0.3) +
geom_polygon(mapping = aes(x = us_tf[,1], y = us_tf[,2]), fill = "blue", alpha = 0.3) +
geom_segment(mapping = aes(x = us[,1], y = us[,2], xend = us_tf[,1], yend = us_tf[,2]),
color = "red", size = 1, arrow = arrow(type = "closed", length = unit(1, "points"))) +
coord_fixed()
ggplot() +
geom_polygon(mapping = aes(x = us[,1], y = us[,2]), fill = "blue", alpha = 0.3) +
geom_polygon(mapping = aes(x = us_tf[,1], y = us_tf[,2]), fill = "blue", alpha = 0.3) +
geom_segment(mapping = aes(x = us[,1], y = us[,2], xend = us_tf[,1], yend = us_tf[,2]),
color = "red", size = 1, arrow = arrow(type = "closed", length = unit(1, "native"))) +
coord_fixed()
ggplot() +
geom_polygon(mapping = aes(x = us[,1], y = us[,2]), fill = "blue", alpha = 0.3) +
geom_polygon(mapping = aes(x = us_tf[,1], y = us_tf[,2]), fill = "blue", alpha = 0.3) +
geom_segment(mapping = aes(x = us[,1], y = us[,2], xend = us_tf[,1], yend = us_tf[,2]),
color = "red", size = 1, arrow = arrow(type = "closed", length = unit(0.1, "native"))) +
coord_fixed()
ggplot() +
geom_polygon(mapping = aes(x = us[,1], y = us[,2]), fill = "blue", alpha = 0.3) +
geom_polygon(mapping = aes(x = us_tf[,1], y = us_tf[,2]), fill = "blue", alpha = 0.3) +
geom_segment(mapping = aes(x = us[,1], y = us[,2], xend = us_tf[,1], yend = us_tf[,2]),
color = "red", size = 1, arrow = arrow(type = "closed", length = unit(0.02, "native"))) +
coord_fixed()
ggplot() +
geom_polygon(mapping = aes(x = us[,1], y = us[,2]), fill = "blue", alpha = 0.3) +
geom_polygon(mapping = aes(x = us_tf[,1], y = us_tf[,2]), fill = "blue", alpha = 0.3) +
geom_segment(mapping = aes(x = us[,1], y = us[,2], xend = us_tf[,1], yend = us_tf[,2]),
color = "red", size = 1, arrow = arrow(type = "closed", length = unit(0.05, "native"))) +
coord_fixed()
ggplot() +
geom_polygon(mapping = aes(x = us[,1], y = us[,2]), fill = "blue", alpha = 0.3) +
geom_path(mapping = aes(x = us_tf[,1], y = us_tf[,2]), fill = "blue", alpha = 0.3) +
geom_segment(mapping = aes(x = us[,1], y = us[,2], xend = us_tf[,1], yend = us_tf[,2]),
color = "red", size = 1, arrow = arrow(type = "closed", length = unit(0.05, "native"))) +
coord_fixed()
ggplot() +
geom_point(mapping = aes(x = us[,1], y = us[,2]), color = "blue", alpha = 0.3) +
geom_polygon(mapping = aes(x = us[,1], y = us[,2]), fill = "blue", alpha = 0.3) +
geom_polygon(mapping = aes(x = us_tf[,1], y = us_tf[,2]), fill = "blue", alpha = 0.3) +
geom_segment(mapping = aes(x = us[,1], y = us[,2], xend = us_tf[,1], yend = us_tf[,2]),
color = "red", size = 1, arrow = arrow(type = "closed", length = unit(0.05, "native"))) +
coord_fixed()
ggplot() +
geom_point(mapping = aes(x = us[,1], y = us[,2]), color = "blue") +
geom_polygon(mapping = aes(x = us[,1], y = us[,2]), fill = "blue", alpha = 0.3) +
geom_polygon(mapping = aes(x = us_tf[,1], y = us_tf[,2]), fill = "blue", alpha = 0.3) +
geom_segment(mapping = aes(x = us[,1], y = us[,2], xend = us_tf[,1], yend = us_tf[,2]),
color = "red", size = 1, arrow = arrow(type = "closed", length = unit(0.05, "native"))) +
coord_fixed()
ggplot() +
geom_point(mapping = aes(x = us[,1], y = us[,2]), color = "blue", size =2) +
geom_polygon(mapping = aes(x = us[,1], y = us[,2]), fill = "blue", alpha = 0.3) +
geom_polygon(mapping = aes(x = us_tf[,1], y = us_tf[,2]), fill = "blue", alpha = 0.3) +
geom_segment(mapping = aes(x = us[,1], y = us[,2], xend = us_tf[,1], yend = us_tf[,2]),
color = "red", size = 1, arrow = arrow(type = "closed", length = unit(0.05, "native"))) +
coord_fixed()
ggplot() +
geom_point(mapping = aes(x = us[,1], y = us[,2]), color = "blue", size =2) +
geom_polygon(mapping = aes(x = us[,1], y = us[,2]), fill = "blue", alpha = 0.3) +
geom_point(mapping = aes(x = us_tf[,1], y = us_tf[,2]), color = "purple", size =2) +
geom_polygon(mapping = aes(x = us_tf[,1], y = us_tf[,2]), fill = "blue", alpha = 0.3) +
geom_segment(mapping = aes(x = us[,1], y = us[,2], xend = us_tf[,1], yend = us_tf[,2]),
color = "red", size = 1, arrow = arrow(type = "closed", length = unit(0.05, "native"))) +
coord_fixed()
ggplot() +
geom_point(mapping = aes(x = us[,1], y = us[,2]), color = "blue", size =2) +
geom_polygon(mapping = aes(x = us[,1], y = us[,2]), fill = "blue", alpha = 0.3) +
geom_point(mapping = aes(x = us_tf[,1], y = us_tf[,2]), color = "red", size =2) +
geom_polygon(mapping = aes(x = us_tf[,1], y = us_tf[,2]), fill = "blue", alpha = 0.3) +
geom_segment(mapping = aes(x = us[,1], y = us[,2], xend = us_tf[,1], yend = us_tf[,2]),
color = "red", size = 1, arrow = arrow(type = "closed", length = unit(0.05, "native"))) +
coord_fixed()
ggplot() +
geom_polygon(mapping = aes(x = us[,1], y = us[,2]), fill = "blue", alpha = 0.3) +
geom_point(mapping = aes(x = us[,1], y = us[,2]), color = "blue", size =2) +
geom_polygon(mapping = aes(x = us_tf[,1], y = us_tf[,2]), fill = "blue", alpha = 0.3) +
geom_point(mapping = aes(x = us_tf[,1], y = us_tf[,2]), color = "red", size =2) +
geom_segment(mapping = aes(x = us[,1], y = us[,2], xend = us_tf[,1], yend = us_tf[,2]),
color = "red", size = 1, arrow = arrow(type = "closed", length = unit(0.05, "native"))) +
coord_fixed()
ggplot() +
geom_polygon(mapping = aes(x = us[,1], y = us[,2]), fill = "blue", alpha = 0.3) +
geom_point(mapping = aes(x = us[,1], y = us[,2]), color = "blue", size =2) +
geom_polygon(mapping = aes(x = us_tf[,1], y = us_tf[,2]), fill = "blue", alpha = 0.3) +
geom_point(mapping = aes(x = us_tf[,1], y = us_tf[,2]), color = "red", size =2) +
geom_segment(mapping = aes(x = us[,1], y = us[,2], xend = us_tf[,1], yend = us_tf[,2]),
color = "black", linetype = "dot", size = 1, arrow = arrow(type = "closed", length = unit(0.05, "native"))) +
coord_fixed()
vignette("ggplot2-specs")
ggplot() +
geom_polygon(mapping = aes(x = us[,1], y = us[,2]), fill = "blue", alpha = 0.3) +
geom_point(mapping = aes(x = us[,1], y = us[,2]), color = "blue", size =2) +
geom_polygon(mapping = aes(x = us_tf[,1], y = us_tf[,2]), fill = "blue", alpha = 0.3) +
geom_point(mapping = aes(x = us_tf[,1], y = us_tf[,2]), color = "red", size =2) +
geom_segment(mapping = aes(x = us[,1], y = us[,2], xend = us_tf[,1], yend = us_tf[,2]),
color = "black", linetype = "dotted", size = 1, arrow = arrow(type = "closed", length = unit(0.05, "native"))) +
coord_fixed()
ggplot() +
geom_polygon(mapping = aes(x = us[,1], y = us[,2]), fill = "grey", alpha = 0.3) +
geom_point(mapping = aes(x = us[,1], y = us[,2]), color = "grey", size =2) +
geom_polygon(mapping = aes(x = us_tf[,1], y = us_tf[,2]), fill = "blue", alpha = 0.3) +
geom_point(mapping = aes(x = us_tf[,1], y = us_tf[,2]), color = "red", size =2) +
geom_segment(mapping = aes(x = us[,1], y = us[,2], xend = us_tf[,1], yend = us_tf[,2]),
color = "black", linetype = "dotted", size = 1, arrow = arrow(type = "closed", length = unit(0.05, "native"))) +
coord_fixed()
ggplot() +
geom_polygon(mapping = aes(x = us[,1], y = us[,2]), fill = "grey", alpha = 0.3) +
geom_point(mapping = aes(x = us[,1], y = us[,2]), color = "grey", size =2) +
geom_polygon(mapping = aes(x = us_tf[,1], y = us_tf[,2]), fill = "grey", alpha = 0.3) +
geom_point(mapping = aes(x = us_tf[,1], y = us_tf[,2]), color = "red", size =2) +
geom_segment(mapping = aes(x = us[,1], y = us[,2], xend = us_tf[,1], yend = us_tf[,2]),
color = "black", linetype = "dotted", size = 1, arrow = arrow(type = "closed", length = unit(0.05, "native"))) +
coord_fixed()
ggplot() +
geom_polygon(mapping = aes(x = us[,1], y = us[,2]), fill = "grey", alpha = 0.3) +
geom_point(mapping = aes(x = us[,1], y = us[,2]), color = "blue", size =2) +
geom_polygon(mapping = aes(x = us_tf[,1], y = us_tf[,2]), fill = "grey", alpha = 0.3) +
geom_point(mapping = aes(x = us_tf[,1], y = us_tf[,2]), color = "red", size =2) +
geom_segment(mapping = aes(x = us[,1], y = us[,2], xend = us_tf[,1], yend = us_tf[,2]),
color = "black", linetype = "dotted", size = 1, arrow = arrow(type = "closed", length = unit(0.05, "native"))) +
coord_fixed()
ggplot() +
geom_polygon(mapping = aes(x = us[,1], y = us[,2]), fill = "grey", alpha = 0.3) +
geom_point(mapping = aes(x = us[,1], y = us[,2]), color = "blue", size =2) +
geom_polygon(mapping = aes(x = us_tf[,1], y = us_tf[,2]), fill = "grey", alpha = 0.3) +
geom_point(mapping = aes(x = us_tf[,1], y = us_tf[,2]), color = "red", size =2) +
geom_segment(mapping = aes(x = us[,1], y = us[,2], xend = us_tf[,1], yend = us_tf[,2]),
color = "black", linetype = "dotted", size = 1, arrow = arrow(type = "closed", length = unit(0.02, "native"))) +
coord_fixed()
ggplot() +
geom_polygon(mapping = aes(x = us[,1], y = us[,2]), fill = "grey", alpha = 0.3) +
geom_point(mapping = aes(x = us[,1], y = us[,2]), color = "blue", size =2) +
geom_polygon(mapping = aes(x = us_tf[,1], y = us_tf[,2]), fill = "grey", alpha = 0.3) +
geom_point(mapping = aes(x = us_tf[,1], y = us_tf[,2]), color = "red", size =2) +
geom_segment(mapping = aes(x = us[,1], y = us[,2], xend = us_tf[,1], yend = us_tf[,2]),
color = "black", linetype = "dotted", size = 1, arrow = arrow(type = "closed", length = unit(0.03, "native"))) +
coord_fixed()
ggplot() +
geom_polygon(mapping = aes(x = us[,1], y = us[,2]), fill = "blue", alpha = 0.3) +
geom_point(mapping = aes(x = us[,1], y = us[,2]), color = "blue", size =2) +
geom_polygon(mapping = aes(x = us_tf[,1], y = us_tf[,2]), fill = "red", alpha = 0.3) +
geom_point(mapping = aes(x = us_tf[,1], y = us_tf[,2]), color = "red", size =2) +
geom_segment(mapping = aes(x = us[,1], y = us[,2], xend = us_tf[,1], yend = us_tf[,2]),
color = "black", linetype = "dotted", size = 1, arrow = arrow(type = "closed", length = unit(0.03, "native"))) +
coord_fixed()
ggplot() +
geom_polygon(mapping = aes(x = us[,1], y = us[,2]), fill = "blue", alpha = 0.3) +
geom_point(mapping = aes(x = us[,1], y = us[,2]), color = "blue", size = 3) +
geom_polygon(mapping = aes(x = us_tf[,1], y = us_tf[,2]), fill = "red", alpha = 0.3) +
geom_point(mapping = aes(x = us_tf[,1], y = us_tf[,2]), color = "red", size = 3) +
geom_segment(mapping = aes(x = us[,1], y = us[,2], xend = us_tf[,1], yend = us_tf[,2]),
color = "black", linetype = "dotted", size = 1, arrow = arrow(type = "closed", length = unit(0.03, "native"))) +
coord_fixed()
