<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Visualize the Network of Grouped Nodes • crosslink</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Visualize the Network of Grouped Nodes">
<meta property="og:description" content="Visualization for Network of Grouped Nodes. 
    Class CrossLink and several methods were implemented to map nodes and edges into the cartesian coordinates, and to easily perform transformation by affine matrix or function mapping (eg. sin/cos, etc).
    Coordinates data could be achieved from CrossLink object, which could be visualized using ggplot2 (eg. geom_point/text/segment, etc.).
    Several useful layouts also being built-in defined, such as column, row, hive, circle, arc, polygon. Users can also custom their own preferred layouts easily using built-in transformation functions.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">crosslink</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div id="crosslink" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#crosslink" class="anchor"></a>crosslink</h1></div>
<!-- badges: start -->
<!-- badges: end -->
<p>The goal of crosslink is to visualize the network of grouped nodes</p>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>You can install the released version of crosslink from <a href="https://github.com/zzwch/crosslink">github</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"crosslink"</span><span class="op">)</span></code></pre></div>
</div>
<div id="example" class="section level2">
<h2 class="hasAnchor">
<a href="#example" class="anchor"></a>Example</h2>
<p>This is a basic example which shows you how to solve a common problem: including the basic function and expand usage of crosslink packages. (写完回来补充，增加超链接) Basic functions: Expand usage:</p>
<div id="1-generate-test-grouped-nodes-data" class="section level3">
<h3 class="hasAnchor">
<a href="#1-generate-test-grouped-nodes-data" class="anchor"></a>1. Generate test grouped nodes data</h3>
<p>Crossproject need nodes (must have two columns: node name and node type), edges data (must have two columns: source node and target node). Crosslink provide the function ‘gen_demo’ to generate demo data. Users can optional define n to generate the specific numbered grouped data.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">crosslink</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org">magrittr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://rlang.r-lib.org">rlang</a></span><span class="op">)</span>

<span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">6</span>
<span class="va">demo</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/gen_demo.html">gen_demo</a></span><span class="op">(</span>n_cross <span class="op">=</span> <span class="va">n</span>,n_node <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">n</span>, n_link <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">n</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span>, seed <span class="op">=</span> <span class="fl">66</span><span class="op">)</span>
<span class="va">nodes</span> <span class="op">&lt;-</span> <span class="va">demo</span><span class="op">$</span><span class="va">nodes</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">nodes</span><span class="op">)</span>
<span class="va">edges</span> <span class="op">&lt;-</span> <span class="va">demo</span><span class="op">$</span><span class="va">edges</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">edges</span><span class="op">)</span>
<span class="va">cross.by</span> <span class="op">&lt;-</span> <span class="va">demo</span><span class="op">$</span><span class="va">cross.by</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">demo</span><span class="op">)</span></code></pre></div>
</div>
<div id="2-crosslink-function-to-generate-crosslink-object-data-for-plot" class="section level3">
<h3 class="hasAnchor">
<a href="#2-crosslink-function-to-generate-crosslink-object-data-for-plot" class="anchor"></a>2. ‘crosslink’ function to generate crosslink object data for plot</h3>
<p>crosslink can help to generate an object of class CroosLink for plot. users can define ‘odd.rm’ to choose if remove the nodes have zero relationship with any other nodes</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cl</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/crosslink.html">crosslink</a></span><span class="op">(</span><span class="va">nodes</span>, <span class="va">edges</span>, <span class="va">cross.by</span>, odd.rm <span class="op">=</span> <span class="cn">F</span>,spaces <span class="op">=</span> <span class="st">"flank"</span><span class="op">)</span>

<span class="va">cl</span> <span class="op">%&gt;%</span> <span class="fu"><a href="reference/get_cross.html">get_cross</a></span><span class="op">(</span><span class="op">)</span>   <span class="co"># get node information</span>
<span class="va">cl</span> <span class="op">%&gt;%</span> <span class="fu"><a href="reference/get_link.html">get_link</a></span><span class="op">(</span><span class="op">)</span>    <span class="co"># get edges information</span>
<span class="va">cl</span> <span class="op">%&gt;%</span> <span class="fu"><a href="reference/cl_xrange.html">cl_xrange</a></span><span class="op">(</span><span class="op">)</span>   <span class="co"># get xrange of crosslink object </span>
<span class="va">cl</span> <span class="op">%&gt;%</span> <span class="fu"><a href="reference/cl_xrange.html">cl_yrange</a></span><span class="op">(</span><span class="op">)</span>   <span class="co"># get yrange of crosslink object </span>
<span class="va">cl</span> <span class="op">%&gt;%</span> <span class="fu"><a href="reference/cl_layouts.html">cl_layouts</a></span><span class="op">(</span><span class="op">)</span>  <span class="co"># get layouts information of crosslink object</span>
<span class="va">cl</span> <span class="op">%&gt;%</span> <span class="fu"><a href="reference/cl_active.html">cl_active</a></span><span class="op">(</span><span class="op">)</span>   <span class="co"># get active layouts information of crosslink object</span>
<span class="co"># Header can be customized through 'set_header'</span>
<span class="fu"><a href="reference/set_header.html">set_header</a></span><span class="op">(</span><span class="va">cl</span>,header <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"A"</span>,<span class="st">"B"</span>,<span class="st">"C"</span>,<span class="st">"D"</span>,<span class="st">"E"</span>,<span class="st">"F"</span><span class="op">)</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">cl</span>
<span class="va">cl</span> <span class="op">%&gt;%</span> <span class="fu"><a href="reference/get_header.html">get_header</a></span><span class="op">(</span><span class="op">)</span>  <span class="co"># get header of crosslink object </span></code></pre></div>
</div>
<div id="3-cl_plot-function-combined-ggplot2-output-relational-graph-simply" class="section level3">
<h3 class="hasAnchor">
<a href="#3-cl_plot-function-combined-ggplot2-output-relational-graph-simply" class="anchor"></a>3. ‘cl_plot’ function combined ggplot2 output relational graph simply</h3>
<p>crosslink meet the needs of directly generating network diagrams</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co"># defalut layout by column; </span>
<span class="co"># use object to generate figure directly</span>

<span class="va">cl</span> <span class="op">%&gt;%</span> <span class="fu"><a href="reference/cl_plot.html">cl_plot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">p1</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">p1</span><span class="op">)</span>

<span class="co">## Beautify nodes, lines through the interface 'cross', 'link','label' and 'header'.</span>
<span class="co">## Beautify the figure as ggplot2 theme provided. </span>
<span class="va">cl</span> <span class="op">%&gt;%</span> 
   <span class="fu"><a href="reference/cl_plot.html">cl_plot</a></span><span class="op">(</span>cross <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">type</span>,shape<span class="op">=</span><span class="va">type</span><span class="op">)</span>,
                       scale <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>color <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu">RColorBrewer</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html">brewer.pal</a></span><span class="op">(</span><span class="fl">8</span>, <span class="st">"Dark2"</span><span class="op">)</span><span class="op">)</span>,
                       shape <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_shape_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fl">15</span><span class="op">:</span><span class="fl">22</span><span class="op">)</span>
                       <span class="op">)</span>,
                       size<span class="op">=</span><span class="fl">10</span>
                       <span class="op">)</span>,
          link <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>color<span class="op">=</span><span class="st">"grey75"</span>,size<span class="op">=</span><span class="fl">1</span>,linetype<span class="op">=</span><span class="fl">11</span><span class="op">)</span>,
          label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>color<span class="op">=</span><span class="st">"white"</span><span class="op">)</span>,
          header <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color<span class="op">=</span> <span class="va">cross</span><span class="op">)</span>,
                       scale <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>color <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu">RColorBrewer</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html">brewer.pal</a></span><span class="op">(</span><span class="fl">8</span>, <span class="st">"Dark2"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,
                       size<span class="op">=</span><span class="fl">5</span>
                       <span class="op">)</span><span class="op">)</span>  <span class="op">-&gt;</span> <span class="va">p1</span>
<span class="va">p1</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span>,
          axis.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,
          plot.margin <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">margin</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">30</span>,<span class="fl">4</span><span class="op">)</span><span class="op">)</span>,
          axis.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,
          axis.ticks <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,
          panel.grid <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,
          panel.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
</div>
<div id="4-crosslink-offers-several-layout-transformation-options" class="section level3">
<h3 class="hasAnchor">
<a href="#4-crosslink-offers-several-layout-transformation-options" class="anchor"></a>4. Crosslink offers several layout transformation options</h3>
<div id="a-layout-by-row" class="section level4">
<h4 class="hasAnchor">
<a href="#a-layout-by-row" class="anchor"></a>a. layout by row</h4>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## set_space 设置后在图上看不出区别,不然去掉？？？</span>？
<span class="va">cl</span> <span class="op">%&gt;%</span> <span class="co">#set_space(spaces=list(crossF="partition")) %&gt;%</span>
   <span class="fu"><a href="reference/Predefined_layouts.html">layout_row</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
   <span class="fu"><a href="reference/cl_plot.html">cl_plot</a></span><span class="op">(</span>cross <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">type</span><span class="op">)</span>,
                       scale <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>color <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu">RColorBrewer</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html">brewer.pal</a></span><span class="op">(</span><span class="fl">8</span>, <span class="st">"Dark2"</span><span class="op">)</span><span class="op">)</span>
                       <span class="co">#,shape = scale_shape_manual(values = rev(15:20))</span>
                       <span class="op">)</span>,
                       size<span class="op">=</span><span class="fl">10</span>,shape<span class="op">=</span><span class="fl">16</span>
                       <span class="op">)</span>,
          link <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>color<span class="op">=</span><span class="st">"grey75"</span>,size<span class="op">=</span><span class="fl">1</span>,linetype<span class="op">=</span><span class="fl">12</span><span class="op">)</span>,
          label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>color<span class="op">=</span><span class="st">"white"</span><span class="op">)</span>,
          header <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color<span class="op">=</span> <span class="va">cross</span><span class="op">)</span>,
                       scale <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>color <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu">RColorBrewer</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html">brewer.pal</a></span><span class="op">(</span><span class="fl">8</span>, <span class="st">"Dark2"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,
                       size<span class="op">=</span><span class="fl">5</span>
                       <span class="op">)</span><span class="op">)</span>  <span class="op">-&gt;</span> <span class="va">p1</span>
<span class="co">#p1</span>

<span class="va">p1</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span>,
          axis.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,
          plot.margin <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">margin</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">30</span>,<span class="fl">4</span><span class="op">)</span><span class="op">)</span>,
          axis.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,
          axis.ticks <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,
          panel.grid <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,
          panel.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
</div>
<div id="b-layout-by-rotate" class="section level4">
<h4 class="hasAnchor">
<a href="#b-layout-by-rotate" class="anchor"></a>b. layout by rotate</h4>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cl</span> <span class="op">%&gt;%</span> 
   <span class="fu"><a href="reference/tf_affine.html">tf_rotate</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">30</span>, by.each.cross <span class="op">=</span> <span class="cn">T</span><span class="op">)</span> <span class="op">%&gt;%</span>
   <span class="fu"><a href="reference/cl_plot.html">cl_plot</a></span><span class="op">(</span>cross <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">type</span><span class="op">)</span>,
                       scale <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>color <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu">RColorBrewer</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html">brewer.pal</a></span><span class="op">(</span><span class="fl">8</span>, <span class="st">"Dark2"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,
                       size<span class="op">=</span><span class="fl">10</span>,shape<span class="op">=</span><span class="fl">16</span>
                       <span class="op">)</span>,
          link <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>color<span class="op">=</span><span class="st">"grey75"</span>,size<span class="op">=</span><span class="fl">1</span>,linetype<span class="op">=</span><span class="fl">15</span><span class="op">)</span>,
          label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>color<span class="op">=</span><span class="st">"white"</span><span class="op">)</span>,
          header <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color<span class="op">=</span> <span class="va">cross</span><span class="op">)</span>,
                       scale <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>color <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu">RColorBrewer</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html">brewer.pal</a></span><span class="op">(</span><span class="fl">8</span>, <span class="st">"Dark2"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,
                       size<span class="op">=</span><span class="fl">5</span>
                       <span class="op">)</span><span class="op">)</span>  <span class="op">-&gt;</span> <span class="va">p1</span>
<span class="va">p1</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span>,
          axis.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,
          plot.margin <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">margin</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">30</span>,<span class="fl">4</span><span class="op">)</span><span class="op">)</span>,
          axis.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,
          axis.ticks <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,
          panel.grid <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,
          panel.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
          
          </code></pre></div>
</div>
<div id="c-layout-by-polygon" class="section level4">
<h4 class="hasAnchor">
<a href="#c-layout-by-polygon" class="anchor"></a>c. layout by polygon</h4>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cl</span> <span class="op">%&gt;%</span> 
   <span class="co">#set_header(header = c("s1","tar1","s2","tar2","s3","tar3")) %&gt;%</span>
   <span class="fu"><a href="reference/Predefined_layouts.html">layout_polygon</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
   <span class="co">#tf_rotate(angle = 45, by.each.cross = F) %&gt;%  # If the grouping is 4, rotate by this parameter and change from diamond to square </span>
   <span class="fu"><a href="reference/cl_plot.html">cl_plot</a></span><span class="op">(</span>cross <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">type</span><span class="op">)</span>,
                       scale <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>color <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu">RColorBrewer</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html">brewer.pal</a></span><span class="op">(</span><span class="fl">8</span>, <span class="st">"Dark2"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,
                       size<span class="op">=</span><span class="fl">10</span>,shape<span class="op">=</span><span class="fl">16</span>
                       <span class="op">)</span>,
          link <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>color<span class="op">=</span><span class="st">"orange"</span>,size<span class="op">=</span><span class="fl">1</span>,linetype<span class="op">=</span><span class="fl">10</span>,geom<span class="op">=</span><span class="st">"curve"</span><span class="op">)</span>,
          label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>color<span class="op">=</span><span class="st">"white"</span><span class="op">)</span>,
          header <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color<span class="op">=</span> <span class="va">cross</span><span class="op">)</span>,
                       scale <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>color <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu">RColorBrewer</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html">brewer.pal</a></span><span class="op">(</span><span class="fl">8</span>, <span class="st">"Dark2"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,
                       size<span class="op">=</span><span class="fl">5</span>
                       <span class="op">)</span><span class="op">)</span>  <span class="op">-&gt;</span> <span class="va">p1</span>
                       
<span class="va">p1</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span>,
          axis.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,
          plot.margin <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">margin</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">30</span>,<span class="fl">4</span><span class="op">)</span><span class="op">)</span>,
          axis.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,
          axis.ticks <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,
          panel.grid <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,
          panel.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
</div>
<div id="d-layout-by-hive" class="section level4">
<h4 class="hasAnchor">
<a href="#d-layout-by-hive" class="anchor"></a>d. layout by hive</h4>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cl</span> <span class="op">%&gt;%</span> 
   <span class="co">#set_header(header = c("s1","tar1","s2","tar2")) %&gt;%</span>
   <span class="fu"><a href="reference/Predefined_layouts.html">layout_hive</a></span><span class="op">(</span>angles<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">30</span>,<span class="fl">3</span><span class="op">)</span>,crosses<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"D"</span>,<span class="st">"E"</span>,<span class="st">"F"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="co">#length of angles must be same with the numbers of groups</span>
   <span class="fu"><a href="reference/cl_plot.html">cl_plot</a></span><span class="op">(</span>cross <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">type</span><span class="op">)</span>,
                       scale <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>color <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu">RColorBrewer</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html">brewer.pal</a></span><span class="op">(</span><span class="fl">8</span>, <span class="st">"Dark2"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,
                       size<span class="op">=</span><span class="fl">10</span>,shape<span class="op">=</span><span class="fl">18</span>
                       <span class="op">)</span>,
          link <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>color<span class="op">=</span><span class="st">"purple"</span>,size<span class="op">=</span><span class="fl">1</span>,linetype<span class="op">=</span><span class="fl">15</span><span class="op">)</span>,
          label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>color<span class="op">=</span><span class="st">"white"</span><span class="op">)</span>,
          header <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color<span class="op">=</span> <span class="va">cross</span><span class="op">)</span>,
                       scale <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>color <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu">RColorBrewer</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html">brewer.pal</a></span><span class="op">(</span><span class="fl">8</span>, <span class="st">"Dark2"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,
                       size<span class="op">=</span><span class="fl">5</span>
                       <span class="op">)</span><span class="op">)</span>  <span class="op">-&gt;</span> <span class="va">p1</span>
                       
<span class="va">p1</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span>,
          axis.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,
          plot.margin <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">margin</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">30</span>,<span class="fl">4</span><span class="op">)</span><span class="op">)</span>,
          axis.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,
          axis.ticks <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,
          panel.grid <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,
          panel.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
</div>
<div id="e-layout-by-arc" class="section level4">
<h4 class="hasAnchor">
<a href="#e-layout-by-arc" class="anchor"></a>e. layout by arc</h4>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cl</span> <span class="op">%&gt;%</span> 
   <span class="co">#set_header(header = c("s1","tar1","s2","tar2")) %&gt;%</span>
   <span class="fu"><a href="reference/Predefined_layouts.html">layout_arc</a></span><span class="op">(</span>angles<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">30</span>,<span class="fl">3</span><span class="op">)</span>,crosses<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"D"</span>,<span class="st">"E"</span>,<span class="st">"F"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="co">#length of angles must be same with the numbers of crosses</span>
   <span class="fu"><a href="reference/cl_plot.html">cl_plot</a></span><span class="op">(</span>cross <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">type</span><span class="op">)</span>,
                       scale <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>color <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu">RColorBrewer</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html">brewer.pal</a></span><span class="op">(</span><span class="fl">8</span>, <span class="st">"Dark2"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,
                       size<span class="op">=</span><span class="fl">10</span>,shape<span class="op">=</span><span class="fl">18</span>
                       <span class="op">)</span>,
          link <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>color<span class="op">=</span><span class="st">"orange"</span>,size<span class="op">=</span><span class="fl">1</span>,linetype<span class="op">=</span><span class="fl">3</span><span class="op">)</span>,<span class="co">#,geom="curve"</span>
          label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>color<span class="op">=</span><span class="st">"white"</span><span class="op">)</span>,
          header <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color<span class="op">=</span> <span class="va">cross</span><span class="op">)</span>,
                       scale <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>color <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu">RColorBrewer</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html">brewer.pal</a></span><span class="op">(</span><span class="fl">8</span>, <span class="st">"Dark2"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,
                       size<span class="op">=</span><span class="fl">5</span>
                       <span class="op">)</span><span class="op">)</span>  <span class="op">-&gt;</span> <span class="va">p1</span>
                       
<span class="va">p1</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span>,
          axis.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,
          plot.margin <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">margin</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">30</span>,<span class="fl">4</span><span class="op">)</span><span class="op">)</span>,
          axis.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,
          axis.ticks <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,
          panel.grid <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,
          panel.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
</div>
<div id="e-layout-by-combination-of-several-methods" class="section level4">
<h4 class="hasAnchor">
<a href="#e-layout-by-combination-of-several-methods" class="anchor"></a>e. layout by combination of several methods</h4>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">5</span>
<span class="va">demo</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/gen_demo.html">gen_demo</a></span><span class="op">(</span>n_cross <span class="op">=</span> <span class="va">n</span>, n_node <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">n</span>, <span class="va">n</span><span class="op">)</span>, n_link <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">n</span>, <span class="va">n</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span>, seed <span class="op">=</span> <span class="fl">66</span><span class="op">)</span>
<span class="va">nodes</span> <span class="op">&lt;-</span> <span class="va">demo</span><span class="op">$</span><span class="va">nodes</span>
<span class="va">edges</span> <span class="op">&lt;-</span> <span class="va">demo</span><span class="op">$</span><span class="va">edges</span>
<span class="va">cross.by</span> <span class="op">&lt;-</span> <span class="va">demo</span><span class="op">$</span><span class="va">cross.by</span>
<span class="va">cl</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/crosslink.html">crosslink</a></span><span class="op">(</span><span class="va">nodes</span>, <span class="va">edges</span>, <span class="va">cross.by</span>, odd.rm <span class="op">=</span> <span class="cn">F</span><span class="op">)</span>
<span class="va">cl</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/set_header.html">set_header</a></span><span class="op">(</span><span class="va">cl</span>,header <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"A"</span>,<span class="st">"B"</span>,<span class="st">"C"</span>,<span class="st">"D"</span>,<span class="st">"E"</span><span class="op">)</span><span class="op">)</span>

<span class="va">cl</span> <span class="op">%&gt;%</span> 
   <span class="fu"><a href="reference/Predefined_layouts.html">layout_polygon</a></span><span class="op">(</span>crosses <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"A"</span>,<span class="st">"B"</span>,<span class="st">"C"</span>,<span class="st">"D"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
   <span class="fu"><a href="reference/tf_affine.html">tf_rotate</a></span><span class="op">(</span>crosses<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"A"</span>,<span class="st">"B"</span>,<span class="st">"C"</span>,<span class="st">"D"</span><span class="op">)</span>,angle <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">45</span>,<span class="fl">4</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
   <span class="fu"><a href="reference/tf_affine.html">tf_shift</a></span><span class="op">(</span>x<span class="op">=</span><span class="fl">0.8</span><span class="op">*</span><span class="op">(</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span>,y<span class="op">=</span><span class="fl">0.05</span>,crosses<span class="op">=</span><span class="st">"E"</span>,layout<span class="op">=</span><span class="st">"default"</span><span class="op">)</span> <span class="op">%&gt;%</span>
   <span class="fu"><a href="reference/cl_plot.html">cl_plot</a></span><span class="op">(</span>cross <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">type</span><span class="op">)</span>,
                       scale <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>color <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu">RColorBrewer</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html">brewer.pal</a></span><span class="op">(</span><span class="fl">8</span>, <span class="st">"Dark2"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,
                       size<span class="op">=</span><span class="fl">10</span>,shape<span class="op">=</span><span class="fl">19</span>
                       <span class="op">)</span>,
          link <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>color<span class="op">=</span><span class="st">"grey75"</span>,size<span class="op">=</span><span class="fl">1</span>,linetype<span class="op">=</span><span class="fl">3</span><span class="op">)</span>,
          label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>color<span class="op">=</span><span class="st">"white"</span><span class="op">)</span>,
          header <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color<span class="op">=</span> <span class="va">cross</span><span class="op">)</span>,
                       scale <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>color <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu">RColorBrewer</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html">brewer.pal</a></span><span class="op">(</span><span class="fl">8</span>, <span class="st">"Dark2"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,
                       size<span class="op">=</span><span class="fl">5</span>
                       <span class="op">)</span><span class="op">)</span>  <span class="op">-&gt;</span> <span class="va">p1</span>
<span class="va">p1</span>
                      
<span class="va">p1</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span>,
          axis.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,
          plot.margin <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">margin</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">30</span>,<span class="fl">4</span><span class="op">)</span><span class="op">)</span>,
          axis.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,
          axis.ticks <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,
          panel.grid <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,
          panel.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">-&gt;</span><span class="va">p1</span>

<span class="va">p1</span>          </code></pre></div>
</div>
</div>
<div id="5-example1-for-multi-columns-data" class="section level3">
<h3 class="hasAnchor">
<a href="#5-example1-for-multi-columns-data" class="anchor"></a>5. Example1: for multi columns data</h3>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># generate data </span>
<span class="co"># nodes</span>
<span class="va">nodes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
  id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"P"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">30</span><span class="op">)</span>,
         <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"RBP"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">)</span>,
         <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"N"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">30</span><span class="op">)</span><span class="op">)</span>,
  type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"P1"</span>, <span class="fl">15</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"P2"</span>, <span class="fl">15</span><span class="op">)</span>,
           <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"RBP"</span>, <span class="fl">20</span><span class="op">)</span>,
           <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"N1"</span>, <span class="fl">15</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"N2"</span>, <span class="fl">15</span><span class="op">)</span><span class="op">)</span>,
  maintype<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"P"</span>, <span class="fl">30</span><span class="op">)</span>,
           <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"RBP"</span>, <span class="fl">20</span><span class="op">)</span>,
           <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"N"</span>, <span class="fl">30</span><span class="op">)</span><span class="op">)</span>,
  strength<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">3</span><span class="op">:</span><span class="fl">10</span>, <span class="fl">80</span>, replace <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>
<span class="op">)</span>

<span class="co"># edges</span>
<span class="va">edges</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span>
  <span class="co"># Positive pathway vs RBP</span>
  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
    source <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="va">nodes</span><span class="op">$</span><span class="va">id</span><span class="op">[</span><span class="va">nodes</span><span class="op">$</span><span class="va">type</span> <span class="op">==</span> <span class="st">"P1"</span> <span class="op">|</span> <span class="va">nodes</span><span class="op">$</span><span class="va">type</span> <span class="op">==</span> <span class="st">"P2"</span><span class="op">]</span>,
                    replace <span class="op">=</span> <span class="cn">T</span>, <span class="fl">100</span><span class="op">)</span>,
    target <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="va">nodes</span><span class="op">$</span><span class="va">id</span><span class="op">[</span><span class="va">nodes</span><span class="op">$</span><span class="va">type</span> <span class="op">==</span> <span class="st">"RBP"</span><span class="op">]</span>,
                    replace <span class="op">=</span> <span class="cn">T</span>, <span class="fl">100</span><span class="op">)</span>,
    maintype<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"P"</span>,<span class="fl">100</span><span class="op">)</span><span class="op">)</span>,
  <span class="co"># Negative pathway vs RBP</span>
  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
    source <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="va">nodes</span><span class="op">$</span><span class="va">id</span><span class="op">[</span><span class="va">nodes</span><span class="op">$</span><span class="va">type</span> <span class="op">==</span> <span class="st">"N1"</span> <span class="op">|</span> <span class="va">nodes</span><span class="op">$</span><span class="va">type</span> <span class="op">==</span> <span class="st">"N2"</span><span class="op">]</span>,
                    replace <span class="op">=</span> <span class="cn">T</span>, <span class="fl">100</span><span class="op">)</span>,
    target <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="va">nodes</span><span class="op">$</span><span class="va">id</span><span class="op">[</span><span class="va">nodes</span><span class="op">$</span><span class="va">type</span> <span class="op">==</span> <span class="st">"RBP"</span><span class="op">]</span>,
                    replace <span class="op">=</span> <span class="cn">T</span>, <span class="fl">100</span><span class="op">)</span>,
    maintype<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"N"</span>,<span class="fl">100</span><span class="op">)</span><span class="op">)</span>
<span class="op">)</span><span class="op">)</span>

<span class="va">nodes</span><span class="op">$</span><span class="va">type</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">nodes</span><span class="op">$</span><span class="va">type</span>,levels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">nodes</span><span class="op">$</span><span class="va">type</span><span class="op">)</span><span class="op">)</span>

<span class="va">cl</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/crosslink.html">crosslink</a></span><span class="op">(</span><span class="va">nodes</span>, <span class="va">edges</span>, cross.by<span class="op">=</span><span class="st">"type"</span>, odd.rm <span class="op">=</span> <span class="cn">F</span>,<span class="op">)</span>

<span class="va">cl</span> <span class="op">%&gt;%</span> <span class="fu"><a href="reference/cl_plot.html">cl_plot</a></span><span class="op">(</span>cross <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">type</span>, shape <span class="op">=</span> <span class="va">type</span>,size<span class="op">=</span><span class="va">strength</span>,fill<span class="op">=</span><span class="va">type</span><span class="op">)</span>,
                       scale <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>color <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu">RColorBrewer</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html">brewer.pal</a></span><span class="op">(</span><span class="fl">8</span>, <span class="st">"Dark2"</span><span class="op">)</span><span class="op">)</span>,
                                    fill <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu">RColorBrewer</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html">brewer.pal</a></span><span class="op">(</span><span class="fl">8</span>, <span class="st">"Dark2"</span><span class="op">)</span><span class="op">)</span>,
                                    shape <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_shape_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">15</span><span class="op">:</span><span class="fl">18</span>,<span class="fl">25</span><span class="op">)</span><span class="op">)</span>,
                                    size<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_size.html">scale_size_continuous</a></span><span class="op">(</span>range<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">8</span><span class="op">)</span><span class="op">)</span>
                                    <span class="op">)</span>
                       <span class="op">)</span>,
               link <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">maintype</span><span class="op">)</span>,size<span class="op">=</span><span class="fl">0.5</span>,linetype<span class="op">=</span><span class="fl">8</span>,
                            scale <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>color <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu">RColorBrewer</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html">brewer.pal</a></span><span class="op">(</span><span class="fl">8</span>, <span class="st">"Set2"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,
               label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>color<span class="op">=</span><span class="st">"black"</span><span class="op">)</span><span class="op">)</span><span class="op">-&gt;</span> <span class="va">p1</span>

                       
<span class="va">p1</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span>,
          axis.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,
          axis.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,
          axis.ticks <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,
          panel.grid <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,
          panel.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">p1</span>
          
<span class="va">p1</span></code></pre></div>
</div>
<div id="6-example2-for-complex-data" class="section level3">
<h3 class="hasAnchor">
<a href="#6-example2-for-complex-data" class="anchor"></a>6. Example2: for complex data</h3>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/YuLab-SMU/aplot">aplot</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://had.co.nz/reshape">reshape</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/trinker/pacman">pacman</a></span><span class="op">)</span>
<span class="fu">pacman</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pacman/man/p_load.html">p_load</a></span><span class="op">(</span><span class="va">tidyverse</span>,<span class="va">ggtree</span>,<span class="va">aplot</span>,<span class="va">reshape</span>,<span class="va">ggExtra</span><span class="op">)</span>

<span class="co">## generate data</span>
<span class="co"># nodes</span>
<span class="va">nodes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
  id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Gene"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Meth"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span>,
         <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Mir"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Drug"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">8</span><span class="op">)</span><span class="op">)</span>,
  type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"Gene"</span>, <span class="fl">10</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"Meth"</span>, <span class="fl">10</span><span class="op">)</span>, 
           <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"Mir"</span>, <span class="fl">6</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"Drug"</span>, <span class="fl">8</span><span class="op">)</span><span class="op">)</span>
  <span class="op">)</span>

<span class="co"># edges</span>
<span class="va">edges</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span>
  <span class="co"># gene vs mir</span>
  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
    source <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="va">nodes</span><span class="op">$</span><span class="va">id</span><span class="op">[</span><span class="va">nodes</span><span class="op">$</span><span class="va">type</span> <span class="op">==</span> <span class="st">"Gene"</span><span class="op">]</span>,
                    replace <span class="op">=</span> <span class="cn">T</span>, <span class="fl">30</span><span class="op">)</span>,
    target <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="va">nodes</span><span class="op">$</span><span class="va">id</span><span class="op">[</span><span class="va">nodes</span><span class="op">$</span><span class="va">type</span> <span class="op">==</span> <span class="st">"Mir"</span><span class="op">]</span>,
                    replace <span class="op">=</span> <span class="cn">T</span>, <span class="fl">30</span><span class="op">)</span>,
    type<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"Gene"</span>,<span class="fl">30</span><span class="op">)</span><span class="op">)</span>,
  <span class="co"># gene vs drug</span>
  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
    source <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="va">nodes</span><span class="op">$</span><span class="va">id</span><span class="op">[</span><span class="va">nodes</span><span class="op">$</span><span class="va">type</span> <span class="op">==</span> <span class="st">"Gene"</span><span class="op">]</span>,
                    replace <span class="op">=</span> <span class="cn">T</span>, <span class="fl">100</span><span class="op">)</span>,
    target <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="va">nodes</span><span class="op">$</span><span class="va">id</span><span class="op">[</span><span class="va">nodes</span><span class="op">$</span><span class="va">type</span> <span class="op">==</span> <span class="st">"Drug"</span><span class="op">]</span>,
                    replace <span class="op">=</span> <span class="cn">T</span>, <span class="fl">100</span><span class="op">)</span>,
    type<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"Gene"</span>,<span class="fl">100</span><span class="op">)</span><span class="op">)</span>,
  <span class="co"># meth vs drug</span>
  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
    source <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="va">nodes</span><span class="op">$</span><span class="va">id</span><span class="op">[</span><span class="va">nodes</span><span class="op">$</span><span class="va">type</span> <span class="op">==</span> <span class="st">"Meth"</span><span class="op">]</span>,
                    replace <span class="op">=</span> <span class="cn">T</span>, <span class="fl">100</span><span class="op">)</span>,
    target <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="va">nodes</span><span class="op">$</span><span class="va">id</span><span class="op">[</span><span class="va">nodes</span><span class="op">$</span><span class="va">type</span> <span class="op">==</span> <span class="st">"Drug"</span><span class="op">]</span>,
                    replace <span class="op">=</span> <span class="cn">T</span>, <span class="fl">100</span><span class="op">)</span>,
    type<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"Meth"</span>,<span class="fl">100</span><span class="op">)</span><span class="op">)</span>,
  <span class="co"># mir vs drug</span>
  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
    source <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="va">nodes</span><span class="op">$</span><span class="va">id</span><span class="op">[</span><span class="va">nodes</span><span class="op">$</span><span class="va">type</span> <span class="op">==</span> <span class="st">"Mir"</span><span class="op">]</span>,
                    replace <span class="op">=</span> <span class="cn">T</span>, <span class="fl">20</span><span class="op">)</span>,
    target <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="va">nodes</span><span class="op">$</span><span class="va">id</span><span class="op">[</span><span class="va">nodes</span><span class="op">$</span><span class="va">type</span> <span class="op">==</span> <span class="st">"Drug"</span><span class="op">]</span>,
                    replace <span class="op">=</span> <span class="cn">T</span>, <span class="fl">20</span><span class="op">)</span>,
    type<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"Drug"</span>,<span class="fl">20</span><span class="op">)</span><span class="op">)</span>
<span class="op">)</span><span class="op">)</span>


<span class="co"># gene annotation</span>
<span class="va">geneData</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
  gene <span class="op">=</span> <span class="va">nodes</span><span class="op">$</span><span class="va">id</span><span class="op">[</span><span class="va">nodes</span><span class="op">$</span><span class="va">type</span> <span class="op">==</span> <span class="st">"Gene"</span><span class="op">]</span>,
  lfc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">nodes</span><span class="op">$</span><span class="va">id</span><span class="op">[</span><span class="va">nodes</span><span class="op">$</span><span class="va">type</span> <span class="op">==</span> <span class="st">"Gene"</span><span class="op">]</span><span class="op">)</span>, <span class="fl">0</span>, <span class="fl">6</span><span class="op">)</span><span class="op">)</span>


<span class="co"># meth annotation</span>
<span class="va">methData</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
  meth <span class="op">=</span> <span class="va">nodes</span><span class="op">$</span><span class="va">id</span><span class="op">[</span><span class="va">nodes</span><span class="op">$</span><span class="va">type</span> <span class="op">==</span> <span class="st">"Meth"</span><span class="op">]</span>,
  lfc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">nodes</span><span class="op">$</span><span class="va">id</span><span class="op">[</span><span class="va">nodes</span><span class="op">$</span><span class="va">type</span> <span class="op">==</span> <span class="st">"Meth"</span><span class="op">]</span><span class="op">)</span>, <span class="op">-</span><span class="fl">0.5</span>, <span class="op">-</span><span class="fl">0.2</span><span class="op">)</span><span class="op">)</span>


<span class="co"># mir annotation</span>
<span class="va">mirData</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
  mir <span class="op">=</span> <span class="va">nodes</span><span class="op">$</span><span class="va">id</span><span class="op">[</span><span class="va">nodes</span><span class="op">$</span><span class="va">type</span> <span class="op">==</span> <span class="st">"Mir"</span><span class="op">]</span>,<span class="co"># set the order as you want</span>
  lfc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">nodes</span><span class="op">$</span><span class="va">id</span><span class="op">[</span><span class="va">nodes</span><span class="op">$</span><span class="va">type</span> <span class="op">==</span> <span class="st">"Mir"</span><span class="op">]</span><span class="op">)</span>, <span class="op">-</span><span class="fl">4</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span>

<span class="co">## crosslink project</span>
<span class="va">cl</span><span class="op">&lt;-</span><span class="fu"><a href="reference/crosslink.html">crosslink</a></span><span class="op">(</span><span class="va">nodes</span>,<span class="va">edges</span>,cross.by<span class="op">=</span><span class="st">"type"</span><span class="op">)</span>

<span class="va">cl</span> <span class="op">%&gt;%</span> <span class="fu"><a href="reference/cl_plot.html">cl_plot</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">cl</span> <span class="op">&lt;-</span><span class="fu"><a href="reference/set_header.html">set_header</a></span><span class="op">(</span><span class="va">cl</span>,header<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="fu"><a href="reference/get_cross.html">get_cross</a></span><span class="op">(</span><span class="va">cl</span><span class="op">)</span><span class="op">$</span><span class="va">cross</span><span class="op">)</span><span class="op">)</span>

<span class="va">cl</span> <span class="op">%&gt;%</span> 
     <span class="fu"><a href="reference/Predefined_layouts.html">layout_polygon</a></span><span class="op">(</span>crosses <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Mir"</span>,<span class="st">"Meth"</span>,<span class="st">"Gene"</span>,<span class="st">"Drug"</span><span class="op">)</span>,layout_based <span class="op">=</span> <span class="st">"default"</span><span class="op">)</span> <span class="op">%&gt;%</span>
     <span class="fu"><a href="reference/tf_affine.html">tf_rotate</a></span><span class="op">(</span>crosses<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Mir"</span>,<span class="st">"Meth"</span>,<span class="st">"Gene"</span>,<span class="st">"Drug"</span><span class="op">)</span>,angle <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">45</span>,<span class="fl">4</span><span class="op">)</span>,layout<span class="op">=</span><span class="st">"default"</span><span class="op">)</span> <span class="op">%&gt;%</span>
     <span class="fu"><a href="reference/tf_affine.html">tf_shift</a></span><span class="op">(</span>x<span class="op">=</span><span class="fl">0.2</span><span class="op">*</span><span class="op">(</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span>,y<span class="op">=</span><span class="fl">1.5</span>,crosses<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Mir"</span>,<span class="st">"Meth"</span><span class="op">)</span>,layout<span class="op">=</span><span class="st">"default"</span><span class="op">)</span> <span class="op">%&gt;%</span>
     <span class="fu"><a href="reference/cl_plot.html">cl_plot</a></span><span class="op">(</span>cross <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span> mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">type</span>,size<span class="op">=</span><span class="va">degree</span>,shape<span class="op">=</span><span class="va">type</span><span class="op">)</span>,
                           scale <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>color <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu">RColorBrewer</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html">brewer.pal</a></span><span class="op">(</span><span class="fl">8</span>, <span class="st">"Dark2"</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,<span class="fl">7</span><span class="op">:</span><span class="fl">9</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>,
                           shape <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_shape_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fl">15</span><span class="op">:</span><span class="fl">23</span><span class="op">)</span>,
                           size <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_size.html">scale_size_continuous</a></span><span class="op">(</span>range<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">8</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,
              link <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>color<span class="op">=</span><span class="st">"grey75"</span>,linetype<span class="op">=</span><span class="fl">6</span><span class="op">)</span>,
              label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>color<span class="op">=</span><span class="st">"black"</span><span class="op">)</span><span class="op">)</span><span class="op">-&gt;</span><span class="va">p1</span>

<span class="va">p1</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span>,
          axis.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,
          axis.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,
          axis.ticks <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,
          panel.grid <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,
          panel.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">-&gt;</span><span class="va">p1</span>
<span class="va">p1</span> 

<span class="va">top</span> <span class="op">&lt;-</span> <span class="va">nodes</span><span class="op">$</span><span class="va">id</span><span class="op">[</span><span class="va">nodes</span><span class="op">$</span><span class="va">type</span> <span class="op">==</span> <span class="st">"Mir"</span><span class="op">]</span> <span class="co"># set the order as you like</span>
<span class="va">bottom</span> <span class="op">&lt;-</span> <span class="va">nodes</span><span class="op">$</span><span class="va">id</span><span class="op">[</span><span class="va">nodes</span><span class="op">$</span><span class="va">type</span> <span class="op">==</span> <span class="st">"Gene"</span><span class="op">]</span> <span class="co"># set the order as you like</span>
<span class="va">right</span> <span class="op">&lt;-</span> <span class="va">nodes</span><span class="op">$</span><span class="va">id</span><span class="op">[</span><span class="va">nodes</span><span class="op">$</span><span class="va">type</span> <span class="op">==</span> <span class="st">"Meth"</span><span class="op">]</span> <span class="co"># set the order as you like</span>



<span class="va">topAnn</span> <span class="op">&lt;-</span>  <span class="va">mirData</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>mir_f <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">mir</span>, <span class="va">top</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">mir</span>,y<span class="op">=</span><span class="op">-</span><span class="va">lfc</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"#E7298A"</span>,
           stat <span class="op">=</span> <span class="st">"identity"</span>,
           width <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span> <span class="co"># 间距跟bar同宽</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">mir</span><span class="op">)</span>, angle <span class="op">=</span> <span class="fl">90</span>, hjust <span class="op">=</span><span class="op">-</span><span class="va">lfc</span>, fontface <span class="op">=</span><span class="st">"italic"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="cn">NULL</span>, y <span class="op">=</span> <span class="st">"log2(Fold Change)"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_classic</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,
        axis.line.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,
        axis.ticks.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="va">topAnn</span>

<span class="co"># Bottom plot</span>
<span class="va">botAnn</span> <span class="op">&lt;-</span> <span class="va">geneData</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>meth_f <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">gene</span>, <span class="va">bottom</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">gene</span>,y<span class="op">=</span><span class="op">-</span><span class="va">lfc</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>fill <span class="op">=</span>  <span class="fu">RColorBrewer</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html">brewer.pal</a></span><span class="op">(</span><span class="fl">8</span>, <span class="st">"Dark2"</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,<span class="fl">7</span><span class="op">:</span><span class="fl">9</span><span class="op">)</span><span class="op">]</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,
           stat <span class="op">=</span> <span class="st">"identity"</span>,
           width <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">gene</span><span class="op">)</span>, angle <span class="op">=</span> <span class="fl">90</span>, hjust <span class="op">=</span><span class="op">-</span><span class="fl">0.2</span>, fontface <span class="op">=</span><span class="st">"italic"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="cn">NULL</span>, y <span class="op">=</span> <span class="st">"Difference"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_classic</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,
        axis.line.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,
        axis.ticks.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="va">botAnn</span>

<span class="co"># left plot</span>
<span class="va">lftAnn</span> <span class="op">&lt;-</span> <span class="va">methData</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>mir_f <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">meth</span>, <span class="va">left</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">meth</span>,y<span class="op">=</span><span class="op">-</span><span class="va">lfc</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="fu">RColorBrewer</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html">brewer.pal</a></span><span class="op">(</span><span class="fl">8</span>, <span class="st">"Dark2"</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,<span class="fl">7</span><span class="op">:</span><span class="fl">9</span><span class="op">)</span><span class="op">]</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>,
           stat <span class="op">=</span> <span class="st">"identity"</span>, 
           width <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="fl">0</span>,label <span class="op">=</span> <span class="va">meth</span><span class="op">)</span>, 
            <span class="co">#fontface ="italic", </span>
            vjust <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>, 
            hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="cn">NULL</span>, y <span class="op">=</span> <span class="st">"log2(Fold Change)"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_classic</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>axis.text.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,
        axis.line.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,
        axis.ticks.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html">coord_flip</a></span><span class="op">(</span><span class="op">)</span>

<span class="va">lftAnn</span>
<span class="va">mat</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">100</span>, <span class="fl">64</span>, replace <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">8</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">cl</span><span class="op">@</span><span class="va">cross</span><span class="op">$</span><span class="va">Drug</span><span class="op">)</span>

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/reshape/man/melt-24.html">melt</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">X1</span>, <span class="va">X2</span>, fill <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
 <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html">geom_tile</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span><span class="op">+</span>
 <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html">scale_fill_gradient2</a></span><span class="op">(</span>low <span class="op">=</span> <span class="st">"blue"</span>, high <span class="op">=</span> <span class="st">"red"</span>, mid <span class="op">=</span> <span class="st">"white"</span>, 
   midpoint <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">""</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">""</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html">coord_fixed</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"left"</span><span class="op">)</span><span class="op">-&gt;</span><span class="va">p2</span>
 

<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://wilkelab.org/cowplot/">cowplot</a></span><span class="op">)</span>
<span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html">plot_grid</a></span><span class="op">(</span><span class="cn">NULL</span>,<span class="va">topAnn</span>,<span class="cn">NULL</span>,<span class="va">p2</span>,<span class="va">p1</span>,<span class="va">lftAnn</span>,<span class="cn">NULL</span>,<span class="va">botAnn</span>,<span class="cn">NULL</span>,ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>

    </code></pre></div>
</div>
<div id="6-example2-for-complex-data-version2" class="section level3">
<h3 class="hasAnchor">
<a href="#6-example2-for-complex-data-version2" class="anchor"></a>6. Example2: for complex data version2</h3>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/YuLab-SMU/aplot">aplot</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://had.co.nz/reshape">reshape</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/trinker/pacman">pacman</a></span><span class="op">)</span>
<span class="fu">pacman</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pacman/man/p_load.html">p_load</a></span><span class="op">(</span><span class="va">tidyverse</span>,<span class="va">ggtree</span>,<span class="va">aplot</span>,<span class="va">reshape</span>,<span class="va">ggExtra</span><span class="op">)</span>

<span class="co">## generate data</span>
<span class="co"># nodes</span>
<span class="va">nodes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
  id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Gene"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Meth"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span>,
         <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Mir"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Drug"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">8</span><span class="op">)</span>,
         <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Tar"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">8</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Path"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span><span class="op">)</span>,
  type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"Gene"</span>, <span class="fl">10</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"Meth"</span>, <span class="fl">10</span><span class="op">)</span>, 
           <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"Mir"</span>, <span class="fl">6</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"Drug"</span>, <span class="fl">8</span><span class="op">)</span>,
           <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"Tar"</span>, <span class="fl">8</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"Path"</span>, <span class="fl">6</span><span class="op">)</span><span class="op">)</span>
  <span class="op">)</span>

<span class="co"># edges</span>
<span class="va">edges</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span>
  <span class="co"># gene vs mir</span>
  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
    source <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="va">nodes</span><span class="op">$</span><span class="va">id</span><span class="op">[</span><span class="va">nodes</span><span class="op">$</span><span class="va">type</span> <span class="op">==</span> <span class="st">"Gene"</span><span class="op">]</span>,
                    replace <span class="op">=</span> <span class="cn">T</span>, <span class="fl">30</span><span class="op">)</span>,
    target <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="va">nodes</span><span class="op">$</span><span class="va">id</span><span class="op">[</span><span class="va">nodes</span><span class="op">$</span><span class="va">type</span> <span class="op">==</span> <span class="st">"Mir"</span><span class="op">]</span>,
                    replace <span class="op">=</span> <span class="cn">T</span>, <span class="fl">30</span><span class="op">)</span>,
    type<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"Gene"</span>,<span class="fl">30</span><span class="op">)</span><span class="op">)</span>,
  <span class="co"># gene vs drug</span>
  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
    source <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="va">nodes</span><span class="op">$</span><span class="va">id</span><span class="op">[</span><span class="va">nodes</span><span class="op">$</span><span class="va">type</span> <span class="op">==</span> <span class="st">"Gene"</span><span class="op">]</span>,
                    replace <span class="op">=</span> <span class="cn">T</span>, <span class="fl">100</span><span class="op">)</span>,
    target <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="va">nodes</span><span class="op">$</span><span class="va">id</span><span class="op">[</span><span class="va">nodes</span><span class="op">$</span><span class="va">type</span> <span class="op">==</span> <span class="st">"Drug"</span><span class="op">]</span>,
                    replace <span class="op">=</span> <span class="cn">T</span>, <span class="fl">100</span><span class="op">)</span>,
    type<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"Gene"</span>,<span class="fl">100</span><span class="op">)</span><span class="op">)</span>,
  <span class="co"># meth vs drug</span>
  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
    source <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="va">nodes</span><span class="op">$</span><span class="va">id</span><span class="op">[</span><span class="va">nodes</span><span class="op">$</span><span class="va">type</span> <span class="op">==</span> <span class="st">"Meth"</span><span class="op">]</span>,
                    replace <span class="op">=</span> <span class="cn">T</span>, <span class="fl">100</span><span class="op">)</span>,
    target <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="va">nodes</span><span class="op">$</span><span class="va">id</span><span class="op">[</span><span class="va">nodes</span><span class="op">$</span><span class="va">type</span> <span class="op">==</span> <span class="st">"Drug"</span><span class="op">]</span>,
                    replace <span class="op">=</span> <span class="cn">T</span>, <span class="fl">100</span><span class="op">)</span>,
    type<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"Meth"</span>,<span class="fl">100</span><span class="op">)</span><span class="op">)</span>,
  <span class="co"># mir vs drug</span>
  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
    source <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="va">nodes</span><span class="op">$</span><span class="va">id</span><span class="op">[</span><span class="va">nodes</span><span class="op">$</span><span class="va">type</span> <span class="op">==</span> <span class="st">"Mir"</span><span class="op">]</span>,
                    replace <span class="op">=</span> <span class="cn">T</span>, <span class="fl">20</span><span class="op">)</span>,
    target <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="va">nodes</span><span class="op">$</span><span class="va">id</span><span class="op">[</span><span class="va">nodes</span><span class="op">$</span><span class="va">type</span> <span class="op">==</span> <span class="st">"Drug"</span><span class="op">]</span>,
                    replace <span class="op">=</span> <span class="cn">T</span>, <span class="fl">20</span><span class="op">)</span>,
    type<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"Drug"</span>,<span class="fl">20</span><span class="op">)</span><span class="op">)</span>,
  
  <span class="co"># drug vs target</span>
  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
    source <span class="op">=</span> <span class="va">nodes</span><span class="op">$</span><span class="va">id</span><span class="op">[</span><span class="va">nodes</span><span class="op">$</span><span class="va">type</span> <span class="op">==</span> <span class="st">"Drug"</span><span class="op">]</span>,
    target <span class="op">=</span> <span class="va">nodes</span><span class="op">$</span><span class="va">id</span><span class="op">[</span><span class="va">nodes</span><span class="op">$</span><span class="va">type</span> <span class="op">==</span> <span class="st">"Tar"</span><span class="op">]</span>,
    type<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"Drug"</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">nodes</span><span class="op">$</span><span class="va">id</span><span class="op">[</span><span class="va">nodes</span><span class="op">$</span><span class="va">type</span> <span class="op">==</span> <span class="st">"Drug"</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>
    <span class="op">)</span>,
  <span class="co"># target vs path</span>
  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
    source <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="va">nodes</span><span class="op">$</span><span class="va">id</span><span class="op">[</span><span class="va">nodes</span><span class="op">$</span><span class="va">type</span> <span class="op">==</span> <span class="st">"Tar"</span><span class="op">]</span>,
                    replace <span class="op">=</span> <span class="cn">T</span>, <span class="fl">15</span><span class="op">)</span>,
    target <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="va">nodes</span><span class="op">$</span><span class="va">id</span><span class="op">[</span><span class="va">nodes</span><span class="op">$</span><span class="va">type</span> <span class="op">==</span> <span class="st">"Path"</span><span class="op">]</span>,
                    replace <span class="op">=</span> <span class="cn">T</span>, <span class="fl">15</span><span class="op">)</span>,
    type<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"Drug"</span>,<span class="fl">15</span><span class="op">)</span><span class="op">)</span>
<span class="op">)</span><span class="op">)</span>


<span class="co"># gene annotation</span>
<span class="va">geneData</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
  gene <span class="op">=</span> <span class="va">nodes</span><span class="op">$</span><span class="va">id</span><span class="op">[</span><span class="va">nodes</span><span class="op">$</span><span class="va">type</span> <span class="op">==</span> <span class="st">"Gene"</span><span class="op">]</span>,
  lfc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">nodes</span><span class="op">$</span><span class="va">id</span><span class="op">[</span><span class="va">nodes</span><span class="op">$</span><span class="va">type</span> <span class="op">==</span> <span class="st">"Gene"</span><span class="op">]</span><span class="op">)</span>, <span class="fl">0</span>, <span class="fl">6</span><span class="op">)</span><span class="op">)</span>


<span class="co"># meth annotation</span>
<span class="va">methData</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
  meth <span class="op">=</span> <span class="va">nodes</span><span class="op">$</span><span class="va">id</span><span class="op">[</span><span class="va">nodes</span><span class="op">$</span><span class="va">type</span> <span class="op">==</span> <span class="st">"Meth"</span><span class="op">]</span>,
  lfc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">nodes</span><span class="op">$</span><span class="va">id</span><span class="op">[</span><span class="va">nodes</span><span class="op">$</span><span class="va">type</span> <span class="op">==</span> <span class="st">"Meth"</span><span class="op">]</span><span class="op">)</span>, <span class="op">-</span><span class="fl">0.5</span>, <span class="op">-</span><span class="fl">0.2</span><span class="op">)</span><span class="op">)</span>


<span class="co"># mir annotation</span>
<span class="va">mirData</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
  mir <span class="op">=</span> <span class="va">nodes</span><span class="op">$</span><span class="va">id</span><span class="op">[</span><span class="va">nodes</span><span class="op">$</span><span class="va">type</span> <span class="op">==</span> <span class="st">"Mir"</span><span class="op">]</span>,<span class="co"># set the order as you want</span>
  lfc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">nodes</span><span class="op">$</span><span class="va">id</span><span class="op">[</span><span class="va">nodes</span><span class="op">$</span><span class="va">type</span> <span class="op">==</span> <span class="st">"Mir"</span><span class="op">]</span><span class="op">)</span>, <span class="op">-</span><span class="fl">4</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span>

<span class="co">## crosslink project</span>
<span class="va">cl</span><span class="op">&lt;-</span><span class="fu"><a href="reference/crosslink.html">crosslink</a></span><span class="op">(</span><span class="va">nodes</span>,<span class="va">edges</span>,cross.by<span class="op">=</span><span class="st">"type"</span><span class="op">)</span>

<span class="va">cl</span> <span class="op">%&gt;%</span> <span class="fu"><a href="reference/cl_plot.html">cl_plot</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">cl</span> <span class="op">&lt;-</span><span class="fu"><a href="reference/set_header.html">set_header</a></span><span class="op">(</span><span class="va">cl</span>,header<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="fu"><a href="reference/get_cross.html">get_cross</a></span><span class="op">(</span><span class="va">cl</span><span class="op">)</span><span class="op">$</span><span class="va">cross</span><span class="op">)</span><span class="op">)</span>

<span class="va">cl</span> <span class="op">%&gt;%</span> 
     <span class="fu"><a href="reference/Predefined_layouts.html">layout_polygon</a></span><span class="op">(</span>crosses <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Mir"</span>,<span class="st">"Meth"</span>,<span class="st">"Gene"</span>,<span class="st">"Drug"</span><span class="op">)</span>,layout_based <span class="op">=</span> <span class="st">"default"</span><span class="op">)</span> <span class="op">%&gt;%</span>
     <span class="fu"><a href="reference/tf_affine.html">tf_rotate</a></span><span class="op">(</span>crosses<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Mir"</span>,<span class="st">"Meth"</span>,<span class="st">"Gene"</span>,<span class="st">"Drug"</span><span class="op">)</span>,angle <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">45</span>,<span class="fl">4</span><span class="op">)</span>,layout<span class="op">=</span><span class="st">"default"</span><span class="op">)</span> <span class="op">%&gt;%</span>
     <span class="fu"><a href="reference/tf_affine.html">tf_shift</a></span><span class="op">(</span>x<span class="op">=</span><span class="fl">0.2</span><span class="op">*</span><span class="op">(</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span>,y<span class="op">=</span><span class="fl">0.65</span>,crosses<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Mir"</span>,<span class="st">"Meth"</span><span class="op">)</span>,layout<span class="op">=</span><span class="st">"default"</span><span class="op">)</span> <span class="op">%&gt;%</span>
     <span class="fu"><a href="reference/tf_affine.html">tf_shift</a></span> <span class="op">(</span>x<span class="op">=</span><span class="fl">0.6</span><span class="op">*</span><span class="op">(</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span>,y<span class="op">=</span><span class="fl">0.05</span>,crosses<span class="op">=</span><span class="st">"Tar"</span>,layout<span class="op">=</span><span class="st">"default"</span><span class="op">)</span> <span class="op">%&gt;%</span>
     <span class="fu"><a href="reference/tf_affine.html">tf_shift</a></span> <span class="op">(</span>x<span class="op">=</span><span class="fl">0.4</span><span class="op">*</span><span class="op">(</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span>,y<span class="op">=</span><span class="fl">0.05</span>,crosses<span class="op">=</span><span class="st">"Path"</span>,layout<span class="op">=</span><span class="st">"default"</span><span class="op">)</span> <span class="op">%&gt;%</span>
     <span class="fu"><a href="reference/cl_plot.html">cl_plot</a></span><span class="op">(</span>cross <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span> mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">type</span>,size<span class="op">=</span><span class="va">degree</span>,shape<span class="op">=</span><span class="va">type</span><span class="op">)</span>,
                           scale <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>color <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu">RColorBrewer</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html">brewer.pal</a></span><span class="op">(</span><span class="fl">8</span>, <span class="st">"Dark2"</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,<span class="fl">7</span><span class="op">:</span><span class="fl">9</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>,
                           shape <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_shape_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fl">15</span><span class="op">:</span><span class="fl">23</span><span class="op">)</span>,
                           size <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_size.html">scale_size_continuous</a></span><span class="op">(</span>range<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">8</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,
              link <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>color<span class="op">=</span><span class="st">"grey75"</span>,linetype<span class="op">=</span><span class="fl">6</span><span class="op">)</span>,
              label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>color<span class="op">=</span><span class="st">"black"</span><span class="op">)</span><span class="op">)</span><span class="op">-&gt;</span><span class="va">p1</span>

<span class="va">p1</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span>,
          axis.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,
          axis.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,
          axis.ticks <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,
          panel.grid <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,
          panel.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">-&gt;</span><span class="va">p1</span>
<span class="va">p1</span> 

<span class="va">top</span> <span class="op">&lt;-</span> <span class="va">nodes</span><span class="op">$</span><span class="va">id</span><span class="op">[</span><span class="va">nodes</span><span class="op">$</span><span class="va">type</span> <span class="op">==</span> <span class="st">"Gene"</span><span class="op">]</span> <span class="co"># set the order as you like</span>
<span class="va">bottom</span> <span class="op">&lt;-</span> <span class="va">nodes</span><span class="op">$</span><span class="va">id</span><span class="op">[</span><span class="va">nodes</span><span class="op">$</span><span class="va">type</span> <span class="op">==</span> <span class="st">"Meth"</span><span class="op">]</span> <span class="co"># set the order as you like</span>
<span class="va">left</span> <span class="op">&lt;-</span> <span class="va">nodes</span><span class="op">$</span><span class="va">id</span><span class="op">[</span><span class="va">nodes</span><span class="op">$</span><span class="va">type</span> <span class="op">==</span> <span class="st">"Mir"</span><span class="op">]</span> <span class="co"># set the order as you like</span>
<span class="va">right</span> <span class="op">&lt;-</span> <span class="va">nodes</span><span class="op">$</span><span class="va">id</span><span class="op">[</span><span class="va">nodes</span><span class="op">$</span><span class="va">type</span> <span class="op">==</span> <span class="st">"Drug"</span><span class="op">]</span> <span class="co"># set the order as you like</span>

 
          
<span class="va">topAnn</span> <span class="op">&lt;-</span> <span class="va">geneData</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>gene_f <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">gene</span>, <span class="va">top</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">gene</span>,y<span class="op">=</span><span class="op">-</span><span class="va">lfc</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"red"</span>,
           stat <span class="op">=</span> <span class="st">"identity"</span>,
           width <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span> <span class="co"># 间距跟bar同宽</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">gene</span><span class="op">)</span>, angle <span class="op">=</span> <span class="fl">90</span>, hjust <span class="op">=</span><span class="op">-</span><span class="fl">0.2</span>, fontface <span class="op">=</span><span class="st">"italic"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="cn">NULL</span>, y <span class="op">=</span> <span class="st">"log2(Fold Change)"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_classic</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,
        axis.line.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,
        axis.ticks.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="va">topAnn</span>

<span class="co"># Bottom plot</span>
<span class="va">botAnn</span> <span class="op">&lt;-</span> <span class="va">methData</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>meth_f <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">meth</span>, <span class="va">bottom</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">meth</span>,y<span class="op">=</span><span class="op">-</span><span class="va">lfc</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"blue"</span>,
           stat <span class="op">=</span> <span class="st">"identity"</span>,
           width <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span>
  <span class="co">#geom_text(mapping = aes(label = gene), angle = 90, hjust =-0.2, fontface ="italic") +</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="cn">NULL</span>, y <span class="op">=</span> <span class="st">"Difference"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_classic</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,
        axis.line.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,
        axis.ticks.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="va">botAnn</span>

<span class="co"># left plot</span>
<span class="va">lftAnn</span> <span class="op">&lt;-</span> <span class="va">mirData</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>mir_f <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">mir</span>, <span class="va">left</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">mir</span>,y<span class="op">=</span><span class="op">-</span><span class="va">lfc</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"red"</span>,
           stat <span class="op">=</span> <span class="st">"identity"</span>, 
           width <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="fl">0</span>,label <span class="op">=</span> <span class="va">mir</span><span class="op">)</span>, 
            <span class="co">#fontface ="italic", </span>
            vjust <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>, 
            hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="cn">NULL</span>, y <span class="op">=</span> <span class="st">"log2(Fold Change)"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_classic</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>axis.text.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,
        axis.line.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,
        axis.ticks.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html">coord_flip</a></span><span class="op">(</span><span class="op">)</span>

<span class="va">lftAnn</span>
<span class="va">mat</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">100</span>, <span class="fl">36</span>, replace <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">6</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">cl</span><span class="op">@</span><span class="va">cross</span><span class="op">$</span><span class="va">Path</span><span class="op">)</span>

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/reshape/man/melt-24.html">melt</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">X1</span>, <span class="va">X2</span>, fill <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
 <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html">geom_tile</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span><span class="op">+</span>
 <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html">scale_fill_gradient2</a></span><span class="op">(</span>low <span class="op">=</span> <span class="st">"blue"</span>, high <span class="op">=</span> <span class="st">"red"</span>, mid <span class="op">=</span> <span class="st">"white"</span>, 
   midpoint <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html">coord_fixed</a></span><span class="op">(</span><span class="op">)</span><span class="op">-&gt;</span><span class="va">p2</span>
 

<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://wilkelab.org/cowplot/">cowplot</a></span><span class="op">)</span>
<span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html">plot_grid</a></span><span class="op">(</span><span class="cn">NULL</span>,<span class="va">botAnn</span>,<span class="cn">NULL</span>,<span class="va">p2</span>,<span class="va">p1</span>,<span class="va">lftAnn</span>,<span class="cn">NULL</span>,<span class="va">topAnn</span>,<span class="cn">NULL</span>,ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>


<span class="fu">grid.arrange</span><span class="op">(</span><span class="st">''</span>,<span class="va">botAnn</span>,<span class="st">''</span>,<span class="va">p1</span>,<span class="va">p1</span>,<span class="va">lftAnn</span>,<span class="st">''</span>,<span class="va">topAnn</span>,<span class="st">''</span>,nrow <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>   </code></pre></div>
</div>
<div id="others" class="section level3">
<h3 class="hasAnchor">
<a href="#others" class="anchor"></a>others</h3>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/YuLab-SMU/aplot">aplot</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://had.co.nz/reshape">reshape</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/trinker/pacman">pacman</a></span><span class="op">)</span>
<span class="fu">pacman</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pacman/man/p_load.html">p_load</a></span><span class="op">(</span><span class="va">tidyverse</span>,<span class="va">ggtree</span>,<span class="va">aplot</span>,<span class="va">reshape</span>,<span class="va">ggExtra</span><span class="op">)</span>

<span class="co"># generate data </span>
<span class="co"># nodes</span>
<span class="va">nodes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
  id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"P"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">30</span><span class="op">)</span>,
         <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"RBP"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">)</span>,
         <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"N"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">30</span><span class="op">)</span><span class="op">)</span>,
  type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"P1"</span>, <span class="fl">15</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"P2"</span>, <span class="fl">15</span><span class="op">)</span>,
           <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"RBP"</span>, <span class="fl">20</span><span class="op">)</span>,
           <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"N1"</span>, <span class="fl">15</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"N2"</span>, <span class="fl">15</span><span class="op">)</span><span class="op">)</span>,
  maintype<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"P"</span>, <span class="fl">30</span><span class="op">)</span>,
           <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"RBP"</span>, <span class="fl">20</span><span class="op">)</span>,
           <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"N"</span>, <span class="fl">30</span><span class="op">)</span><span class="op">)</span>,
  strength<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">3</span><span class="op">:</span><span class="fl">10</span>, <span class="fl">80</span>, replace <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>
<span class="op">)</span>

<span class="co"># edges</span>
<span class="va">edges</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span>
  <span class="co"># Positive pathway vs RBP</span>
  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
    source <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="va">nodes</span><span class="op">$</span><span class="va">id</span><span class="op">[</span><span class="va">nodes</span><span class="op">$</span><span class="va">type</span> <span class="op">==</span> <span class="st">"P1"</span> <span class="op">|</span> <span class="va">nodes</span><span class="op">$</span><span class="va">type</span> <span class="op">==</span> <span class="st">"P2"</span><span class="op">]</span>,
                    replace <span class="op">=</span> <span class="cn">T</span>, <span class="fl">100</span><span class="op">)</span>,
    target <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="va">nodes</span><span class="op">$</span><span class="va">id</span><span class="op">[</span><span class="va">nodes</span><span class="op">$</span><span class="va">type</span> <span class="op">==</span> <span class="st">"RBP"</span><span class="op">]</span>,
                    replace <span class="op">=</span> <span class="cn">T</span>, <span class="fl">100</span><span class="op">)</span>,
    maintype<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"P"</span>,<span class="fl">100</span><span class="op">)</span><span class="op">)</span>,
  <span class="co"># Negative pathway vs RBP</span>
  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
    source <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="va">nodes</span><span class="op">$</span><span class="va">id</span><span class="op">[</span><span class="va">nodes</span><span class="op">$</span><span class="va">type</span> <span class="op">==</span> <span class="st">"N1"</span> <span class="op">|</span> <span class="va">nodes</span><span class="op">$</span><span class="va">type</span> <span class="op">==</span> <span class="st">"N2"</span><span class="op">]</span>,
                    replace <span class="op">=</span> <span class="cn">T</span>, <span class="fl">100</span><span class="op">)</span>,
    target <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="va">nodes</span><span class="op">$</span><span class="va">id</span><span class="op">[</span><span class="va">nodes</span><span class="op">$</span><span class="va">type</span> <span class="op">==</span> <span class="st">"RBP"</span><span class="op">]</span>,
                    replace <span class="op">=</span> <span class="cn">T</span>, <span class="fl">100</span><span class="op">)</span>,
    maintype<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"N"</span>,<span class="fl">100</span><span class="op">)</span><span class="op">)</span>
<span class="op">)</span><span class="op">)</span>

<span class="va">nodes</span><span class="op">$</span><span class="va">type</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">nodes</span><span class="op">$</span><span class="va">type</span>,levels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">nodes</span><span class="op">$</span><span class="va">type</span><span class="op">)</span><span class="op">)</span>

<span class="va">cl</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/crosslink.html">crosslink</a></span><span class="op">(</span><span class="va">nodes</span>, <span class="va">edges</span>, cross.by<span class="op">=</span><span class="st">"type"</span>, odd.rm <span class="op">=</span> <span class="cn">F</span>,<span class="op">)</span>

<span class="va">cl</span> <span class="op">%&gt;%</span> <span class="fu"><a href="reference/cl_plot.html">cl_plot</a></span><span class="op">(</span>cross <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">type</span>, shape <span class="op">=</span> <span class="va">maintype</span>,size<span class="op">=</span><span class="va">strength</span><span class="op">)</span>,
                       scale <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">'scale_color_manual(values = RColorBrewer::brewer.pal(8, "Set1"))'</span>,
                                    shape <span class="op">=</span> <span class="st">"scale_shape_manual(values = 15:22)"</span>,
                                    size<span class="op">=</span><span class="st">'scale_size_continuous(range=c(1,6))'</span>
                                    <span class="op">)</span>,
                       <span class="op">)</span>,
               link <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">maintype</span><span class="op">)</span>,scale <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">'scale_color_manual(values = RColorBrewer::brewer.pal(8, "Set2"))'</span><span class="op">)</span><span class="op">)</span>,
               label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>color<span class="op">=</span><span class="st">"black"</span><span class="op">)</span><span class="op">)</span><span class="op">-&gt;</span> <span class="va">p1</span>

                       
<span class="va">p1</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span>,
          axis.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,
          axis.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,
          axis.ticks <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,
          panel.grid <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,
          panel.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">p1</span>


<span class="co">## aplot need the same xrange or yrange for combination</span>

<span class="va">bar_data</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>id<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">6</span>,<span class="fl">10</span><span class="op">)</span>,value<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">15</span>,<span class="op">-</span><span class="fl">5</span>,<span class="op">-</span><span class="fl">10</span>,<span class="op">-</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">bar_data</span>,<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">id</span>,y<span class="op">=</span><span class="va">value</span><span class="op">)</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_classic</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">p2</span>
<span class="va">bar_data</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>id<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">6</span>,<span class="fl">10</span><span class="op">)</span>,value<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">5</span>,<span class="fl">12</span>,<span class="fl">15</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">bar_data</span>,<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">id</span>,y<span class="op">=</span><span class="va">value</span><span class="op">)</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_classic</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">p4</span>


<span class="co">## generate heatmap</span>
<span class="fu">pacman</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pacman/man/p_load.html">p_load</a></span><span class="op">(</span><span class="va">tidyverse</span>,<span class="va">ggtree</span>,<span class="va">aplot</span>,<span class="va">reshape</span>,<span class="va">ggExtra</span><span class="op">)</span>

<span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">16</span><span class="op">)</span>, ncol<span class="op">=</span><span class="fl">4</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">'D'</span>, <span class="fl">4</span><span class="op">:</span><span class="fl">1</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">'t'</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span>
<span class="va">hc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/hclust.html">hclust</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html">dist</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span><span class="op">)</span>  
<span class="va">hcc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/hclust.html">hclust</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html">dist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> 
<span class="va">phr</span> <span class="op">&lt;-</span> <span class="fu">ggtree</span><span class="op">(</span><span class="va">hc</span><span class="op">)</span>  <span class="co">#行聚类树</span>NA<span class="va">phc</span> <span class="op">&lt;-</span> <span class="fu">ggtree</span><span class="op">(</span><span class="va">hcc</span><span class="op">)</span> <span class="op">+</span> <span class="fu">layout_dendrogram</span><span class="op">(</span><span class="op">)</span> <span class="co">#列聚类树</span>NA<span class="co">#d &lt;- data.frame(d)</span>

<span class="va">d</span><span class="op">$</span><span class="va">gene</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span> 
<span class="va">dd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/reshape/man/melt-24.html">melt</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span>

<span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">dd</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">variable</span>,<span class="va">gene</span>,fill<span class="op">=</span><span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html">geom_tile</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html">scale_fill_viridis_c</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html">scale_y_discrete</a></span><span class="op">(</span>position<span class="op">=</span><span class="st">"right"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span> 


<span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">15</span>,<span class="op">-</span><span class="fl">5</span>,by<span class="op">=</span><span class="fl">3</span><span class="op">)</span>
<span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">15</span>,<span class="op">-</span><span class="fl">5</span><span class="op">)</span>
<span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html">expand.grid</a></span><span class="op">(</span>X<span class="op">=</span><span class="va">x</span>, Y<span class="op">=</span><span class="va">y</span><span class="op">)</span>
<span class="va">data</span><span class="op">$</span><span class="va">Z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">44</span>, <span class="fl">0</span>, <span class="fl">5</span><span class="op">)</span>

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">Y</span>, fill<span class="op">=</span> <span class="va">Z</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html">geom_tile</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span>,
          axis.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,
          plot.margin <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">margin</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">30</span>,<span class="fl">4</span><span class="op">)</span><span class="op">)</span>,
          axis.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,
          axis.ticks <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,
          panel.grid <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,
          panel.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">-&gt;</span><span class="va">p3</span>


<span class="fu">ggarrange</span><span class="op">(</span><span class="st">''</span>,<span class="va">botAnn</span>,<span class="st">''</span>,<span class="st">''</span>,<span class="va">p1</span>,<span class="va">lftAnn</span>,<span class="st">''</span>,<span class="va">topAnn</span>,<span class="st">''</span>,ncol <span class="op">=</span> <span class="fl">3</span>,nrow <span class="op">=</span> <span class="fl">3</span>,common.legend <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></code></pre></div>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li>
<a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | file <a href="LICENSE-text.html">LICENSE</a>
</li>
</ul>
</div>
<div class="Catalogue">
<h2>Catalogue</h2>
<ul class="list-unstyled">
<li><a href="#1-generate-test-grouped-nodes-data" >1. Generate test grouped nodes data </a></li>
<li><a href="#2-crosslink-function-to-generate-crosslink-object-data-for-plot">2. ‘crosslink’ function to generate crosslink object data for plot</a></li>
<li><a href="#3-cl_plot-function-combined-ggplot2-output-relational-graph-simply">3. ‘cl_plot’ function combined ggplot2 output relational graph simply</a></li>
<li><a href="#4-crosslink-offers-several-layout-transformation-options">4. Crosslink offers several layout transformation options</a></li>
<li><a href="#5-example1-for-multi-columns-data" >5. Example1: for multi columns data</a></li>
<li><a href="#6-example2-for-complex-data">6. Example2: for complex data</a></li>

</ul>
</div>

<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Zongcheng Li <br><small class="roles"> Maintainer </small>  </li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p>Developed by Zongcheng Li.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
